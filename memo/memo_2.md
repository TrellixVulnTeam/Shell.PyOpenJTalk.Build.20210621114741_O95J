# OpenJTalkのGUIを作りたい

　かんたんに音声合成をたのしめるアプリを作ってみたい。

<!-- more -->

# 案

1. [とにかく発話する](#talk)
2. [オプション設定する](#optional_talk)
3. [台本を読む](#from_file)
4. [ニュースを読む](#from_rss)
5. [サイトを読む](#from_html)
6. [イベントトリガを指定して実行する](#from_event)

```
talk|opt|file|rss|html|event
----------------------------
各UI
```

<a id="talk"></a>
## 1. [とにかく発話する](#talk)

```
[ここに音声合成したいテキストを入力してください。Enterキーを押下すると発話します。▼]
```

1. テキストボックスに任意のテキストを入力する
2. Enterキーを押下する
3. 発話する

　ところで、以下のようなときはテキストを記憶させたくなる。

* いろいろなテキストを試したい
* 前のテキストを発話させたい

　なので以下のように記憶しておく。

1. 発話したテキストがプルダウン（コンボボックス）に残る
2. プルダウンから選択するとそのテキストが発話される

<a id="optional_talk"></a>
## 2. [オプション設定する](#optional_talk)

```
[ここに音声合成したいテキストを入力してください。Enterキーを押下すると発話します。▼][削除]
[options設定とテキストを任意名で保存します▼]
options----------------------------------------+
| voice [                                     ]|
| Speed        [1.0]  SamplingFrequency [48000]|
| HalfTone     [0.0]  FramePeriod       [-1]   |
| AllPass      [-1]   BufferBize        [0.0]  |
|                                              |
| Postfiltering[0.0]                           |
| Threshold    [0.5]                           |
| Weight       [1.0]                           |
| WeightF0     [1.0]                           |
| Volume       [0.0]                           |
+----------------------------------------------+
```

　OpenJTalkはオプションによって声の質などを変更できる。さまざまなオプションを試したい。

　また、それらのオプションを保存し、再現できるようにしたい。

　オプション設定ごとに名前をつけて保存できるようにしたい。それを後から選んで再現できるようにしたい。

<a id="from_file"></a>
## 3. [台本を読む](#from_file)

```
[まとめて話す▼]　☑DnD後に発話する
[URL▼]
+---------------------------------------------------------------------------+
|音声合成したいテキストを入力してください。                                 |
|またはファイルをここにDnDするとここにテキストが入力されます。              |
|または台本ファイルのURLを入力するとここにテキストが入力されます。          |
|                                                                           |
|句点`。`ごとに音声合成します。                                             |
|[まとめて話す]ボタンを押下すると発話します。                               |
|[まとめて話す]ボタンを押下すると発話します。                               |
+---------------------------------------------------------------------------+
```

　テキストファイルに読み上げるセリフをまとめておきたい。それをまとめて読み上げてほしい。

　台本はおもに次のような内容のTSVである。

```
オプション設定名	セリフ
オプション設定名	セリフ
オプション設定名	セリフ
...
```

　選んだファイルパスはプルダウンに記憶される。

　なお、台本ファイルはURLでもよい。

<a id="from_rss"></a>
## 4. [ニュースを読む](#from_rss)

```
[ニュースを読む RSS URL▼][RSS 追加URL]
[読み上げオプション設定▼]
+---------------------------------------------------------------------------+
|ログ                                                                       |
+---------------------------------------------------------------------------+
```

　指定したRSSのURLからタイトルと概要を取得して読み上げる。

　読み上げ時間が長くなりすぎるかもしれない。いくらかの工夫がほしい。

* 読み上げスピードを指定する
* すでに読み上げた内容はログに残して読み上げない
* 事前にニュース件数を読み上げる
* 事前に推定所要時間を読み上げる

　定期的にポーリングして未読のニュースが来たら随時読み上げてほしい。

* `ピコン（効果音）。新しいニュースです。（ニュース本文読み上げ）`

　天気予報を読み上げてほしい。

<a id="from_html"></a>
## 5. [サイトを読む](#from_html)

```
[サイトを読む▼][URL]
```

　指定したRSSのURLから`<article>`要素の内容をプレーンテキストで取得し、それを読み上げる。

　スクレイピングが必要か。たとえばTwitterなど特定サイトの解析スクリプトを書く必要があるかもしれない。

　長すぎて困るときがあるかもしれない。いつでも中断できるようにしたい。また、途中から再開できるようにしたい。

<a id="from_event"></a>
## 6. [イベントトリガを指定して実行する](#from_event)

```
トリガ
　時間
　　[一定間隔ごとに読み上げる]
　　[定刻になったら読み上げる]
　　[所定の日時に読み上げる]
　受信
　　ネットワーク監視
　　　メール
　　　チャット
　　ファイル監視
　　　[path]
内容
　[とにかく発話する](#talk)
　[オプション設定する](#optional_talk)
　[台本を読む](#from_file)
　[ニュースを読む](#from_rss)
　[サイトを読む](#from_html)
　[イベントトリガを指定して実行する](#from_event)
```

　ある契機をもって発話する。契機はおもに時間と受信。時間なら時報やタイマーのように使える。

　受信はPCにおける各イベントである。たとえば有用なイベントとしてはメールやチャットの受信など。ほかにもネットワークを監視して所定の通信がなされたときに実行するよう定義できたらよい。ついでに特定ファイルの変更があったときにも通知できるとローカル内のイベントは大体カバーできるだろう。Linuxはすべてファイル管理されるのでデバイスに変更があったときにも対応できるはず。たとえばUSBになにか差し込まれた時など。

# 所感

　

# 対象環境

* <time datetime="2021-07-09T09:44:29+0900" title="実施日">2021-07-09</time>
* [Raspbierry pi](https://ja.wikipedia.org/wiki/Raspberry_Pi) 4 Model B
* [Raspberry Pi OS](https://ja.wikipedia.org/wiki/Raspbian) buster 10.0 2020-08-20 [※](http://ytyaru.hatenablog.com/entry/2020/10/06/111111)
* [bash](https://ja.wikipedia.org/wiki/Bash) 5.0.3(1)-release

```sh
$ uname -a
Linux raspberrypi 5.4.83-v7l+ #1379 SMP Mon Dec 14 13:11:54 GMT 2020 armv7l GNU/Linux
```
